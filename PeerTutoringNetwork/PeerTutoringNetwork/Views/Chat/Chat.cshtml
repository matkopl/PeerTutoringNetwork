@model PeerTutoringNetwork.Viewmodels.UserVM

<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

@{
    ViewData["Title"] = "Chat";
    Layout = "_Layout";
}

<div class="container">
    <h2>Chat with @Model.UserName</h2>
    <label id="currentUserLabel">Current User: </label>
    <!-- Add your chat UI here -->
</div>

<script>
$(document).ready(function() {
    const token = localStorage.getItem('jwtToken');

    if (token) {
        const decodedToken = jwt_decode(token);
        const userId = decodedToken.userId;

        $.ajax({
            url: '@Url.Action("GetUserVMById", "Chat")?userId=' + userId,            
            method: 'GET',
            success: function(data) {
                console.log('User:', data);
                $('#currentUserLabel').text('Current User: ' + data.userName);
            },
            error: function(error) {
                console.error('Error fetching user:', error);
                $('#currentUserLabel').text('Error fetching user');
            }
        });
    } else {
        $('#currentUserLabel').text('No token found');
    }
});
</script>